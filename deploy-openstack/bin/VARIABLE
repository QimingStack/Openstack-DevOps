#!/bin/bash 
#Edit the below variable to adapt your Env..

#------------------------Need to choose the network card  first -----------------------

MGMT_IP_DEVICE=ens4


#openvswitch 
#which bridge name you want to create 
br_provider=br-ex

#Replace PROVIDER_INTERFACE with the name of the underlying interface that handles provider networks. For example, eth1
PROVIDER_INTERFACE=eth1

#this is neutron for ext ip
COMPUTE_NET1_CARD_NAME=eth1
CONTROLLER_VIP=10.245.58.205



#--------------------------------------- For controller only -----------------------------------------------------------------------------
#if unkown the ifconfig command you can use : ip addr show <NET_NAMES> | grep 'inet[^6]' | sed -n '1p' | awk '{print $2}' | awk -F "/" '{print $1}' 
#ntp server ad controller management ip
NTP_SERVER_IP=$(ifconfig $MGMT_IP_DEVICE | grep 'inet[^6]' | sed -n '1p' | awk '{print $2}')

#MGMT_IP is the controller management ip 
MGMT_IP=$(ifconfig $MGMT_IP_DEVICE | grep 'inet[^6]' | sed -n '1p' | awk '{print $2}')

#set mariadb password 
MARIADB_PASSWORD=admin

#set the rabbitmq host and password as below 
RABBIT_HOSTS=$(ifconfig $MGMT_IP_DEVICE | grep 'inet[^6]' | sed -n '1p' | awk '{print $2}')
RABBIT_PASS=rabbitmq

#--------------------Keystone ------------------
#set keystone database password 
KEYSTONE_DBPASS=keystone_dbpassword
ADMIN_PASS=admin
DEMO_PASS=demo
#Which directory you want to store the admin-openrc file ?
OPENRC_DIR=/home


#-----------------Glance-------------
#glance database password
GLANCE_DBPASS=glancedb
#glance password use for keystone
GLANCE_PASS=glance


#-----------------Nova for controller node --------
#both nova and nova_api database use this
NOVA_DBPASS=novadb
#nova pass for keystone 
NOVA_PASS=novapass
#nova.conf need my_ip 
#In the [DEFAULT] section, configure the my_ip option to use the management interface IP address of the controller node
#my_ip here:
MY_IP_CONTROLLER=$(ifconfig $MGMT_IP_DEVICE | grep 'inet[^6]' | sed -n '1p' | awk '{print $2}')

#--------------------Neutron for controller -----------
NEUTRON_DBPASS=neutrondb
NEUTRON_PASS=neutron

#--------------------Cinder for controller 
CINDERDB_PASS=cinderdb
CINDER_PASS=cinderpass

#---------------Controller HA proxy -----------
#This need to edit by  manual



#-------------------------------------nova compute node ------------------------------------------------------
#list the compute node management networkd card name (for example : eth0 em1)


COMPUTE_MANAGEMENT_INTERFACE_IP_ADDRESS=$(ifconfig $MGMT_IP_DEVICE | grep 'inet[^6]' | sed -n '1p' | awk '{print $2}')
Management_ip=$(ifconfig $MGMT_IP_DEVICE | grep 'inet[^6]' | sed -n '1p' | awk '{print $2}')
Compute_host=$(cat ./COMPUTE_HOSTS)



#use for linuxbridge_agent.ini this need make sure 
PROVIDER_INTERFACE_NAME=${COMPUTE_NET1_CARD_NAME}
OVERLAY_INTERFACE_IP_ADDRESS=$(ifconfig $MGMT_IP_DEVICE | grep 'inet[^6]' | sed -n '1p' | awk '{print $2}')

#Edit the /etc/neutron/metadata_agent.ini 
METADATA_SECRET=secert_here

#Neutron for compute node 
COMPUTE_PROVIDER_INTERFACE_NAME=${COMPUTE_NET1_CARD_NAME}
COMPUTE_OVERLAY_INTERFACE_IP_ADDRESS=$(ifconfig $MGMT_IP_DEVICE | grep 'inet[^6]' | sed -n '1p' | awk '{print $2}')

#cinder for compute node
#management network interface on your storage node （storage management ip）
CINDER_MANAGEMENT_INTERFACE_IP_ADDRESS=$(ifconfig $MGMT_IP_DEVICE | grep 'inet[^6]' | sed -n '1p' | awk '{print $2}')



